/*! TSL Textures v2.3.0 */
"use strict";var o=require("three/tsl"),e=require("three");const a=o.Fn((([e,a,r,t])=>{var s=t.add(e.mul(12)).mod(12),l=a.mul(o.min(r,o.sub(1,r)));return r.sub(l.mul(o.max(-1,o.min(o.min(s.sub(3),o.sub(9,s)),1))))}));a.setLayout({name:"hslHelper",type:"float",inputs:[{name:"h",type:"float"},{name:"s",type:"float"},{name:"l",type:"float"},{name:"n",type:"float"}]});const r=o.Fn((([e,r,t])=>{e=e.fract().add(1).fract(),r=r.clamp(0,1),t=t.clamp(0,1);var s=a(e,r,t,0),l=a(e,r,t,8),n=a(e,r,t,4);return o.vec3(s,l,n)}));r.setLayout({name:"hsl",type:"vec3",inputs:[{name:"h",type:"float"},{name:"s",type:"float"},{name:"l",type:"float"}]});const t=o.Fn((([e])=>{var a=o.float(e.x).toVar(),r=o.float(e.y).toVar(),t=o.float(e.z).toVar(),s=o.max(a,o.max(r,t)).toVar(),l=o.min(a,o.min(r,t)).toVar(),n=o.float(0).toVar(),i=o.float(0).toVar(),m=o.add(s,l).div(2);return o.If(l.notEqual(s),(()=>{const e=o.sub(s,l).toVar();i.assign(o.select(m.lessThanEqual(.5),e.div(o.add(l,s)),e.div(o.sub(2,o.add(l,s))))),o.If(s.equal(a),(()=>{n.assign(o.sub(r,t).div(e).add(o.select(r.lessThanEqual(t),6,0)))})).ElseIf(s.equal(r),(()=>{n.assign(o.sub(t,a).div(e).add(2))})).Else((()=>{n.assign(o.sub(a,r).div(e).add(4))})),n.divAssign(6)})),o.vec3(n,i,m)}));t.setLayout({name:"toHsl",type:"vec3",inputs:[{name:"rgb",type:"vec3"}]});const s=o.Fn((([e,a])=>o.vec3(o.sin(a).mul(o.sin(e)),o.cos(e),o.cos(a).mul(o.sin(e)))));s.setLayout({name:"spherical",type:"vec3",inputs:[{name:"phi",type:"float"},{name:"theta",type:"float"}]});const l=o.Fn((([o,e])=>{var a=n(e);return i(o,a)}));l.setLayout({name:"applyEuler",type:"vec4",inputs:[{name:"vec",type:"vec3"},{name:"eu",type:"vec3"}]});const n=o.Fn((([e])=>{var a=o.cos(e.x.div(2)),r=o.cos(e.y.div(2)),t=o.cos(e.z.div(2)),s=o.sin(e.x.div(2)),l=o.sin(e.y.div(2)),n=o.sin(e.z.div(2));return o.vec4(o.add(o.mul(s,r,t),o.mul(a,l,n)),o.sub(o.mul(a,l,t),o.mul(s,r,n)),o.add(o.mul(a,r,n),o.mul(s,l,t)),o.sub(o.mul(a,r,t),o.mul(s,l,n)))}));n.setLayout({name:"quaternionFromEuler",type:"vec4",inputs:[{name:"eu",type:"vec3"}]});const i=o.Fn((([e,a])=>{var r=o.cross(a.xyz,e).mul(2).toVar();return o.add(e,r.mul(a.w),o.cross(a.xyz,r))}));i.setLayout({name:"applyQuaternion",type:"vec3",inputs:[{name:"vec",type:"vec3"},{name:"quat",type:"vec4"}]});const m=o.Fn((([e,a,r,t,s])=>(e=o.remap(e,a,r,0,1),e=o.pow(2,o.mul(e,o.log2(s.div(t))).add(o.log2(t))))));m.setLayout({name:"remapExp",type:"float",inputs:[{name:"x",type:"float"},{name:"fromMin",type:"float"},{name:"fromMax",type:"float"},{name:"toMin",type:"float"},{name:"toMax",type:"float"}]});const d=o.Fn((([e])=>e.dot(o.vec3(12.9898,78.233,-97.5123)).sin().mul(43758.5453).fract().mul(2).sub(1)));d.setLayout({name:"vnoise",type:"float",inputs:[{name:"v",type:"vec3"}]});const u=o.Fn((([e])=>{var a=e.cos().toVar(),r=e.sin().toVar();return o.mat4(1,0,0,0,0,a,r,0,0,r.negate(),a,0,0,0,0,1)}));u.setLayout({name:"matRotX",type:"mat4",inputs:[{name:"angle",type:"float"}]});const c=o.Fn((([e])=>{var a=e.cos().toVar(),r=e.sin().toVar();return o.mat4(a,0,r.negate(),0,0,1,0,0,r,0,a,0,0,0,0,1)}));c.setLayout({name:"matRotY",type:"mat4",inputs:[{name:"angle",type:"float"}]});const p=o.Fn((([e])=>{var a=e.cos().toVar(),r=e.sin().toVar();return o.mat4(a,r,0,0,r.negate(),a,0,0,0,0,1,0,0,0,0,1)}));p.setLayout({name:"matRotZ",type:"mat4",inputs:[{name:"angle",type:"float"}]});const x=o.Fn((([o])=>{var e=u(o.x),a=c(o.y),r=p(o.z);return a.mul(e).mul(r)}));x.setLayout({name:"matRotYXZ",type:"mat4",inputs:[{name:"angles",type:"vec3"}]});const v=o.Fn((([e])=>o.mat4(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)));v.setLayout({name:"matScale",type:"mat4",inputs:[{name:"scales",type:"vec3"}]});const y=o.Fn((([e])=>o.mat4(1,0,0,0,0,1,0,0,0,0,1,0,e.x,e.y,e.z,1)));y.setLayout({name:"matTrans",type:"mat4",inputs:[{name:"vector",type:"vec3"}]});const f=o.Fn((([e,a,r,t])=>{var l=s(a.x,a.y).mul(t).toVar(),n=r.sub(l.div(2)).sub(e).dot(l).div(l.dot(l)).negate();return o.smoothstep(0,1,n)}));f.setLayout({name:"selectPlanar",type:"float",inputs:[{name:"pos",type:"vec3"},{name:"selAngles",type:"vec2"},{name:"selCenter",type:"vec3"},{name:"selWidth",type:"float"}]});const g=o.Fn((e=>{var a=f(o.positionGeometry,e.selectorAngles,e.selectorCenter,e.selectorWidth).sub(.5).mul(2).abs().oneMinus().pow(.25).negate().mul(e.selectorShow);return o.vec3(0,a,a)})),b=o.Fn((([e])=>{var a=o.dFdx(e),r=o.dFdy(e);return o.transformNormalToView(o.cross(a,r).normalize())}));b.setLayout({name:"normalVector",type:"vec3",inputs:[{name:"pos",type:"vec3"}]});var V=null,_=10;function w(a,r){var t=[];for(var s of a)if(s&&"object"==typeof s){t=Object.keys(s);break}var l={...r};for(var n of t)void 0!==a[n]&&(l[n]=a[n]);for(var i of Object.keys(l))"number"==typeof l[i]?l[i]=o.float(l[i]):l[i]instanceof e.Color?l[i]=o.vec3(l[i].r,l[i].g,l[i].b):l[i]instanceof e.Vector3&&(l[i]=o.vec3(l[i].x,l[i].y,l[i].z));return l}function h(e,a=1,r=1,t=0){return o.mx_noise_float(e.mul(a,r).add(t))}function C(e,a,r=null){const t=o.Fn(e,r),s=new Map;s.set("defaults",a),s.set("opacity",null),s.set("roughness",null),s.set("normal",null);const l=function(){};return Object.setPrototypeOf(l,Object.getPrototypeOf(t.call)),new Proxy(l,{get:(o,e,a)=>"defaults"===e?s.get("defaults"):"opacity"===e?s.get("opacity"):"roughness"===e?s.get("roughness"):"normal"===e?s.get("normal"):"fn"===e?t:Reflect.get(t,e,a),set:(o,e,a,r)=>"defaults"===e?(s.set("defaults",a),!0):"opacity"===e?(s.set("opacity",a),!0):"roughness"===e?(s.set("roughness",a),!0):"normal"===e?(s.set("normal",a),!0):Reflect.set(t,e,a,r),apply:(o,e,a)=>Reflect.apply(t,e,a),getOwnPropertyDescriptor:(o,e)=>"defaults"===e?{value:s.get("defaults"),writable:!0,enumerable:!0,configurable:!0}:("opacity"===e&&Reflect.getOwnPropertyDescriptor(null,e),"roughness"===e&&Reflect.getOwnPropertyDescriptor(null,e),"normal"===e&&Reflect.getOwnPropertyDescriptor(null,e),Reflect.getOwnPropertyDescriptor(t,e))})}var z={$name:"Brain",scale:2,smooth:.5,wave:.5,speed:2.5,color:new e.Color(16765136),background:new e.Color(5242880),seed:0},G=C((e=>{e=w(e,z);var a=o.positionGeometry.mul(o.exp(e.scale.div(3))).add(e.seed).toVar(),r=o.exp(e.smooth.oneMinus().mul(2)),t=o.mx_fractal_noise_float(a.mul(5),r).add(1).div(2).clamp(0,1).pow(2);return o.mix(e.color,e.background,t)}),z);G.normal=C((e=>{e=w(e,z);var a=o.positionGeometry.mul(o.exp(e.scale.div(3))).add(e.seed).toVar(),r=o.exp(e.smooth.oneMinus().mul(2)),t=.01,s=o.mx_fractal_noise_float(a.mul(5),r),l=o.mx_fractal_noise_float(a.add(o.vec3(t,0,0)).mul(5),r).sub(s).div(t),n=o.mx_fractal_noise_float(a.add(o.vec3(0,t,0)).mul(5),r).sub(s).div(t),i=o.mx_noise_float(a.mul(e.wave.mul(5))).add(1).div(2).mul(6.28);return o.vec3(l,n,o.time.mul(e.speed).add(i).sin().add(s,1)).normalize()}),z);var k={$name:"Camouflage",scale:2,colorA:new e.Color(12762792),colorB:new e.Color(10258782),colorC:new e.Color(9610101),colorD:new e.Color(7435617),seed:0},M=C((e=>{e=w(e,k);var a=o.positionGeometry.mul(o.exp(e.scale)).add(e.seed).toVar(),r=o.vec3(0,0,0).toVar();return o.If(o.round(o.mx_noise_float(a,1,.2)).greaterThanEqual(1),(()=>{r.assign(e.colorA)})).ElseIf(o.round(o.mx_noise_float(a.yzx,1,.3)).greaterThanEqual(1),(()=>{r.assign(e.colorB)})).ElseIf(o.round(o.mx_noise_float(a.zxy,1,.4)).greaterThanEqual(1),(()=>{r.assign(e.colorC)})).Else((()=>{r.assign(e.colorD)})),r}),k),$={$name:"Cave art",scale:2,thinness:2,noise:.3,color:new e.Color(13845829),background:new e.Color(16775408),seed:0},A=C((e=>{e=w(e,$);var a=o.positionGeometry.mul(o.exp(e.scale)).add(e.seed).toVar(),r=o.mx_noise_float(a,4).sin().toVar(),t=o.mx_noise_float(a.mul(1.5),4).cos().toVar(),s=o.exp(o.sub(o.float(3),e.thinness)),l=o.sub(s,o.pow2(o.abs(o.add(r,t))).mul(20)).toVar();return o.If(o.or(r.greaterThan(t),l.lessThan(0)),(()=>{l.assign(0)})),o.If(l.lessThanEqual(0),(()=>{l.assign(e.noise.mul(o.pow2(o.mx_noise_float(a.mul(30)))))})),o.mix(e.background,e.color,l)}),$),L={$name:"Circles",scale:2,variety:1,color:new e.Color(15786192),flat:0,seed:0},F=C((e=>{e=w(e,L);for(var a=o.select(e.flat,o.positionGeometry,o.positionGeometry.normalize()),s=o.acos(o.clamp(a.y,-1,1)).mul(20),l=o.exp(e.scale.sub(1)),n=s.div(3e3).mul(l),i=o.float(e.seed.sin().mul(100)).toVar(),m=0;m<=10;m++)i.addAssign(o.sin(n.mul(2**m).sub(Math.PI*m/2)).mul(-m*(m+1)/2));i.assign(i.div(200).clamp(-2,2));var d=t(e.color),u=d.x.add(i.mul(e.variety)).mod(1).mul(10),c=u.floor(),p=u.sub(c);return p=o.select(p.lessThan(.5),p.pow(1.5),p.pow(1/1.5)),r(c.add(p).div(10),d.y,d.z)}),L),I={$name:"Clouds",scale:2,density:.5,opacity:1,color:new e.Color(16777215),subcolor:new e.Color(10526896),seed:0},P=o.Fn((e=>{const a=o.positionGeometry,r=o.exp(e.scale.div(1.5).sub(.5)),t=o.add(h(a,r,1,e.seed),h(a,r,2,e.seed).mul(.8),h(a,r,6,e.seed).mul(.1),h(a,r,8,e.seed).mul(.07,e.opacity),e.density.remap(0,1,-.5,1.5)),s=o.clamp(0,1,o.mul(t,2).pow(1.5).sub(1).mul(e.opacity));return o.vec4(o.mix(e.subcolor,e.color,t.clamp(0,1)),s)})),T=C((o=>(o=w(o,I),P(o).rgb)),I);T.opacity=C((o=>(o=w(o,I),P(o).a)),I);var S={$name:"Concrete",$normalNode:!0,scale:2,density:.5,bump:.5,seed:0},E=o.Fn((([e,a,r,t,s])=>{var l=o.mx_noise_float(e.add(s)).mul(.5).add(.5);return l=r.mul(o.pow(o.abs(l),t)),e.add(l.mul(a))})),R=C((e=>{e=w(e,S);var a=o.positionGeometry.mul(o.exp(e.scale.div(2).add(2))).toVar(),r=o.normalLocal.normalize().toVar(),t=o.tangentLocal.normalize().mul(.001).toVar(),s=o.cross(r,t).normalize().mul(.001).toVar(),l=o.remap(e.density,0,1,10,.5).toVar(),n=o.vec3(o.sin(e.seed).mul(100),o.cos(e.seed.div(2)).mul(100),o.sin(e.seed.div(3)).mul(100)).toVar(),i=E(a,r,e.bump,l,n),m=E(a.add(t),r,e.bump,l,n),d=E(a.add(s),r,e.bump,l,n),u=o.sub(m,i),c=o.sub(d,i);return o.transformNormalToView(o.cross(u,c).normalize())}),S),B={$name:"Cork",scale:1,straight:1,noise:.3,color:new e.Color(16773312),background:new e.Color(13664352),seed:0},W=o.Fn((([o])=>o.add(d(o)))),q=C((e=>{e=w(e,B);var a=o.positionGeometry.mul(o.exp(e.scale.div(1.5).add(1))).add(e.seed).toVar(),r=a.round().toVar(),t=r.toVar(),s=o.float(1).toVar(),l=o.vec3().toVar(),n=o.float().toVar(),i=o.float(0).toVar();o.Loop(27,(()=>{var m=i.mod(3).sub(1),d=i.div(3).floor().mod(3).sub(1),u=i.div(9).floor().sub(1);l.assign(r.add(o.vec3(m,d,u))),n.assign(a.distance(W(l))),n.addAssign(o.mx_noise_float(a.add(l)).div(e.straight.exp())),o.If(n.lessThan(s),(()=>{s.assign(n),t.assign(l)})),i.addAssign(1)}));var m=o.mx_noise_float(t.mul(Math.PI)).toVar(),d=o.mx_noise_float(a.mul(12)).toVar();d.assign(d.sign().mul(d.abs().pow3())),d.addAssign(o.mx_noise_float(a.mul(40)).div(3));var u=m.add(1).div(2);return o.mix(e.color,e.background,u.add(d.mul(e.noise))).toVar()}),B),N={$name:"Dalmatian spots",$width:260,scale:2,density:.6,color:new e.Color(16777215),background:new e.Color(0),seed:0},D=C((e=>{e=w(e,N);var a=o.positionGeometry.mul(o.exp(e.scale)).add(e.seed).sub(1e3).toVar(),r=o.float(1).toVar(),t=o.float(1.5).sub(e.density).mul(2).toVar(),s=e.density.mul(5).add(5).toVar();return o.Loop(s,(()=>{r.mulAssign(o.mx_noise_float(a).abs().pow(t).mul(100).sub(50).clamp(0,1).oneMinus()),a.assign(a.mul(1.01)),r.mulAssign(o.mx_noise_float(a.yzx).abs().pow(t).mul(100).sub(50).clamp(0,1).oneMinus()),a.assign(a.mul(1.01)),r.mulAssign(o.mx_noise_float(a.zxy).abs().pow(t).mul(100).sub(50).clamp(0,1).oneMinus()),a.assign(a.mul(1.01))})),o.mix(e.background,e.color,r.clamp(0,1))}),N),O={$name:"Darth Maul",scale:2,shift:new e.Vector3(0,0,0),complexity:0,angle:60,distance:1.9,color:new e.Color(15745088),background:new e.Color(0),balance:0,seed:0},U=C((e=>{e=w(e,O);var a=o.positionGeometry.add(e.shift).mul(o.exp(e.scale.div(1.5).sub(1))).sub(e.shift).mul(o.vec3(1,.5,.5)).toVar(),r=o.select(o.positionGeometry.y.mul(e.angle.radians().cos()).add(o.positionGeometry.z.mul(e.angle.radians().sin())).greaterThan(e.distance),1,0);a.x.assign(a.x.add(e.shift.x).abs()),a.y.addAssign(e.seed),a.z.mulAssign(e.shift.z);var t=o.mx_noise_float(a).toVar(),s=t.sin().mul(t.mul(e.complexity.mul(2).add(1).exp()).sin()).remap(0,.2,1,-1).greaterThan(e.balance).select(0,1),l=o.select(a.x.greaterThan(o.mx_noise_float(a.mul(2.3)).abs().mul(.5).add(.02)),1,0);return o.mix(e.background,e.color,s.mul(r).mul(l).clamp(0,1))}),O),Y={$name:"Dyson sphere",scale:2,complexity:2,variation:0,color:new e.Color(12636415),background:new e.Color(0),seed:0},j=o.Fn((([e])=>{var a=e.mul(5**.5).fract().toVar();return a.addAssign(a.dot(a.add(o.vec3(31.4159,27.1828,14.142)))),a.z.mul(a.x.add(a.y)).fract().mul(2).sub(1)})),H=o.Fn((([e])=>{var a=e.oneMinus().clamp(0,1).toVar();return a.mul(a).mul(o.float(3).sub(a.mul(2)))})),Z=o.Fn((([e])=>{var a=e.x.floor().toVar(),r=a.add(1).toVar(),t=e.y.floor().toVar(),s=t.add(1).toVar(),l=e.z.floor().toVar(),n=l.add(1).toVar(),i=H(e.x.fract()).toVar(),m=H(e.y.fract()).toVar(),d=H(e.z.fract()).toVar(),u=H(i.oneMinus()).toVar(),c=H(m.oneMinus()).toVar(),p=H(d.oneMinus()).toVar(),x=j(o.vec3(a,t,l)).mul(u).mul(c).mul(p).toVar(),v=j(o.vec3(a,t,n)).mul(u).mul(c).mul(d).toVar(),y=j(o.vec3(a,s,l)).mul(u).mul(m).mul(p).toVar(),f=j(o.vec3(a,s,n)).mul(u).mul(m).mul(d).toVar(),g=j(o.vec3(r,t,l)).mul(i).mul(c).mul(p).toVar(),b=j(o.vec3(r,t,n)).mul(i).mul(c).mul(d).toVar(),V=j(o.vec3(r,s,l)).mul(i).mul(m).mul(p).toVar(),_=j(o.vec3(r,s,n)).mul(i).mul(m).mul(d).toVar();return x.add(v).add(y).add(f).add(g).add(b).add(V).add(_)})),X=C((e=>{e=w(e,Y);var a=o.positionGeometry.mul(o.exp(e.scale.div(2).add(.5))).add(e.seed).toVar(),r=o.vec3().toVar(),t=o.float(1).toVar();return o.Loop(e.complexity.add(4),(()=>{r.addAssign(Z(a.mul(t))),t.addAssign(t)})),o.mix(e.background,e.color,r.x.add(1).div(5))}),Y),K={$name:"Entangled",scale:2,density:10,color:new e.Color(8256),background:new e.Color(16777215),seed:0},Q=C((e=>{e=w(e,K);var a=o.exp(e.scale.div(2)).toVar(),r=o.positionGeometry.add(e.seed).toVar(),t=o.float(-1e4).toVar(),s=o.float(0).toVar();return o.Loop(o.floor(o.float(e.density)),(()=>{s.assign(o.sin(o.mx_noise_float(o.mul(r,a)).mul(3*Math.PI))),t.assign(o.max(t,s)),a.mulAssign(1.2)})),t.assign(o.oneMinus(o.pow(o.abs(t),5)).mul(6)),o.mix(e.color,e.background,t)}),K),J={$name:"Fordite",scale:2,color:new e.Color(0,0,0),seed:0},oo=C((e=>{e=w(e,J);var a=o.positionGeometry.mul(o.exp(e.scale)).add(e.seed).toVar(),t=o.mx_noise_float(o.vec3(o.mx_noise_float(a),o.mx_noise_float(a).mul(2),o.mx_noise_float(a).mul(3))).toVar();return r(t,1,o.sin(o.mul(t,Math.PI,4)).mul(.5).add(.5)).add(e.color)}),J),eo={$name:"Gas giant",scale:2,turbulence:.3,blur:.6,colorA:new e.Color(16775408),colorB:new e.Color(15788208),colorC:new e.Color(11509968),seed:0},ao=C((e=>{var a=(e=w(e,eo)).scale.div(2).add(1).toVar(),s=o.positionGeometry.mul(o.exp(a)).add(e.seed).toVar(),l=e.turbulence.mul(o.mx_noise_float(o.vec3(0,s.y.mul(.5),0).add(1)).add(o.mx_noise_float(o.vec3(0,s.y.mul(1),0).add(1)).mul(.5),o.mx_noise_float(o.vec3(1,s.y.mul(2),1).add(1)).mul(.25))).mul(5).abs().toVar(),n=o.mx_noise_float(s.div(4)).add(1).div(2).pow(10).mul(10).smoothstep(0,1);s.addAssign(o.vec3(o.mx_noise_float(s),o.mx_noise_float(s.yxz),o.mx_noise_float(s.yzx)).mul(l.mul(n.mul(2).exp())));var i=e.blur.pow(.2).oneMinus().mul(l.add(1)).toVar(),m=o.mx_noise_float(s.mul(o.vec3(0,a,0)));m=(m=m.add(o.mx_noise_float(s.mul(o.vec3(1,15,1))).mul(i))).add(-.5).smoothstep(-1,1).oneMinus();var d=o.mx_noise_float(o.vec3(0,s.y.mul(.75),0)).add(1),u=t(o.mix(e.colorB,e.colorA,d)),c=r(u.x.add(o.mx_noise_float(s.mul(o.vec3(0,a,0))).div(4)),u.y,u.z).toVar();return c.assign(o.mix(c,e.colorC,l.mul(.3))),c.mul(m)}),eo),ro={$name:"Grid",countU:32,countV:16,thinness:.8,color:new e.Color(0),background:new e.Color(16777215),flat:0},to=C((e=>{e=w(e,ro);var a=o.select(e.flat,o.screenSize.x.div(o.screenSize.y),2),r=o.select(e.flat,o.screenUV,o.equirectUV(o.positionGeometry.normalize())).toVar(),t=o.mul(r.x,a,Math.PI),s=o.mul(r.y,Math.PI).toVar(),l=o.div(o.round(o.mul(r.x,e.countU)),e.countU),n=o.div(o.round(o.mul(r.y,e.countV)),e.countV),i=o.mul(l,a,Math.PI),m=o.mul(n,Math.PI),d=o.abs(o.sub(t,i)).mul(o.select(e.flat,1,o.sin(s))),u=o.abs(o.sub(s,m)),c=o.min(d,u),p=o.mul(o.min(o.div(a.mul(Math.PI),e.countU),o.div(Math.PI,e.countV)),o.remapClamp(o.pow(e.thinness,.5),0,1,.9,.04),.5),x=o.oneMinus(o.smoothstep(o.sub(p,.002),o.add(p,.002),c));return o.mix(e.background,e.color,x)}),ro),so={$name:"Isolines",scale:2,density:40,blur:.3,thinness:.6,color:new e.Color(16777215),background:new e.Color(0),seed:0},lo=C((e=>{e=w(e,so);var a=o.positionGeometry.mul(o.exp(e.scale)).add(e.seed).toVar(),r=o.mx_noise_float(a).mul(e.density);return r=o.oneMinus(o.sin(r)).div(2),r=o.smoothstep(o.sub(e.thinness,e.blur),o.add(e.thinness,e.blur),r),o.mix(e.color,e.background,r)}),so),no={$name:"Karst rock",scale:2,color:new e.Color(16774384),background:new e.Color(13684944),seed:0},io=C((e=>{e=w(e,no);var a=o.positionGeometry.mul(o.exp(e.scale)).add(e.seed.sin().mul(5)).toVar(),r=a.add(o.mx_noise_float(a.mul(2))).toVar(),t=o.mx_noise_float(r).div(o.mx_noise_float(r.mul(1.01))).clamp(0,2).toVar();return t.addAssign(o.mx_noise_float(a.mul(100)).div(3)),t.addAssign(o.mx_noise_float(a.mul(2)).div(2)),o.mix(e.background,e.color,t).mul(t.pow(.1))}),no),mo={$name:"Marble",scale:1.2,thinness:5,noise:.3,color:new e.Color(4539859),background:new e.Color(15792383),seed:0},uo=C((e=>{e=w(e,mo);var a=o.positionGeometry.mul(o.exp(e.scale)).add(e.seed).toVar(),r=o.add(o.mx_noise_float(a),o.mx_noise_float(a.mul(2)).mul(.5),o.mx_noise_float(a.mul(6)).mul(.1)),t=(r=o.oneMinus(r.abs().pow(2.5)).toVar(),o.oneMinus(o.pow(.5,e.thinness.add(7))).toVar()),s=o.oneMinus(o.pow(.5,e.thinness.add(7).mul(.5))).toVar();return o.If(r.greaterThan(t),(()=>{r.assign(1)})).ElseIf(r.lessThan(s),(()=>{r.assign(0)})).Else((()=>{var e=r.sub(s),l=t.sub(s);r.assign(o.pow(o.div(e,l),5).mul(.75)),r.assign(r.mul(o.add(.5,o.mx_noise_float(a.mul(2)).mul(1.5))))})),r.assign(r.add(o.mul(e.noise,o.mx_noise_float(a.mul(150)).abs().pow3()))),o.mix(e.background,e.color,r)}),mo),co={$name:"Neon Lights",scale:1.5,thinness:.8,mode:0,colorA:new e.Color(16711680),colorB:new e.Color(65280),colorC:new e.Color(255),background:new e.Color(0),seed:0},po=C((e=>{e=w(e,co);var a=o.positionGeometry,s=o.exp(e.scale.remap(0,4,2,-2)).toVar(),l=o.exp(e.thinness.remap(0,1,1.5,0)).toVar(),n=e.background.toVar(),i=o.vec3(0).toVar(),m=o.mx_noise_float(a.xyz).toVar(),d=o.mx_noise_float(a.yzx).toVar(),u=o.mx_noise_float(a.zxy).toVar(),c=o.mx_noise_float(o.vec3(m,d,u).mul(s).add(e.seed)).toVar();c.assign(o.oneMinus(o.sqrt(o.abs(c))).pow(3)),i.assign(e.colorA);var p=t(i);i.assign(r(p.x,p.y,p.z.mul(c))),n.addAssign(o.select(e.mode.equal(0),i,i.negate()).mul(l)),c.assign(o.mx_noise_float(o.vec3(d,u,m).mul(s).sub(e.seed))),c.assign(o.oneMinus(o.sqrt(o.abs(c))).pow(3)),i.assign(e.colorB);p=t(i);i.assign(r(p.x,p.y,p.z.mul(c))),n.addAssign(o.select(e.mode.equal(0),i,i.negate()).mul(l)),c.assign(o.mx_noise_float(o.vec3(u,m,d.negate()).mul(s).add(e.seed))),c.assign(o.oneMinus(o.sqrt(o.abs(c))).pow(3)),i.assign(e.colorC);p=t(i);return i.assign(r(p.x,p.y,p.z.mul(c))),n.addAssign(o.select(e.mode.equal(0),i,i.negate()).mul(l)),n}),co),xo={$name:"Photosphere",scale:2,color:new e.Color(16776960),background:new e.Color(16711680),seed:0},vo=C((e=>{e=w(e,xo);var a=o.exp(e.scale.add(1)).toVar(),r=o.positionGeometry.toVar(),t=o.vec3(r).toVar();o.Loop(6,(()=>{t.assign(l(t,r.mul(a))),a.mulAssign(e.seed.mul(a).sin().mul(.05).add(1.1))}));var s=o.mx_noise_float(t).add(1).div(2);return o.mix(e.background,e.color,s)}),xo),yo={$name:"Planet",scale:2,iterations:5,levelSea:.3,levelMountain:.7,balanceWater:.3,balanceSand:.2,balanceSnow:.8,colorDeep:new e.Color(1194585).convertLinearToSRGB(),colorShallow:new e.Color(8900331).convertLinearToSRGB(),colorBeach:new e.Color(16775885).convertLinearToSRGB(),colorGrass:new e.Color(3978097).convertLinearToSRGB(),colorForest:new e.Color(12288).convertLinearToSRGB(),colorSnow:new e.Color(15794175).convertLinearToSRGB(),seed:0},fo=C((e=>{e=w(e,yo);var a=o.float(0).toVar(),r=o.float(0).toVar(),t=o.exp(e.scale.sub(2)).toVar(),s=o.float(2).toVar();o.Loop(e.iterations.add(10),(()=>{a.addAssign(o.mul(s,o.mx_noise_float(o.positionGeometry.mul(t).add(e.seed)))),r.addAssign(s),t.mulAssign(1.5),s.mulAssign(.8)})),a.assign(o.mul(a,a,.5).div(r));var l=e.levelSea.pow(2).toVar(),n=e.levelMountain.pow(2).toVar(),i=o.mix(l,n,e.balanceSand).toVar(),m=o.mix(l,i,.4).toVar(),d=o.mix(l,i,.6).toVar(),u=o.vec3().toVar();return o.If(a.lessThan(l),(()=>{u.assign(o.mix(e.colorDeep,e.colorShallow,o.remap(a,0,l,0,1).pow(o.exp(e.balanceWater.mul(-8).add(4)))))})).ElseIf(a.lessThan(m),(()=>{u.assign(o.mix(e.colorShallow,e.colorBeach,o.remap(a,l,m)))})).ElseIf(a.lessThan(d),(()=>{u.assign(e.colorBeach)})).ElseIf(a.lessThan(i),(()=>{u.assign(o.mix(e.colorBeach,e.colorGrass,o.remap(a,d,i)))})).ElseIf(a.lessThan(n),(()=>{u.assign(o.mix(e.colorGrass,e.colorForest,o.remap(a,i,n).pow(.75)))})).Else((()=>{var r=o.mix(1,n,e.balanceSnow);u.assign(o.mix(e.colorForest,e.colorSnow,o.smoothstep(o.mix(r,n,e.balanceSnow.pow(.5)),r,a)))})),u}),yo),go={$name:"Polka dots",count:2,size:.5,blur:.25,color:new e.Color(0),background:new e.Color(16777215),flat:0},bo=(1+5**.5)/2,Vo=C((e=>{e=w(e,go);var a=o.float(1).toVar();o.If(e.flat.equal(1),(()=>{var r=e.count.pow(2).sub(.5).toVar(),t=o.positionGeometry.xy.mul(r).mul(o.mat2(1,1,-1,1)),s=t.round().toVar();a.assign(t.distance(s).div(r))})).Else((()=>{var r=o.pow(10,e.count).toVar(),t=o.positionGeometry.normalize().toVar(),l=o.oneMinus(t.y).mul(r).sub(1).div(2),n=o.max(10,r.pow(.5)),i=l.sub(n).floor().clamp(0,r),m=l.add(n).floor().clamp(0,r);a.assign(1).toVar(),o.Loop(m.sub(i),(({i:e})=>{var l=o.add(e,i),n=o.mod(o.mul(2*Math.PI/bo,l),2*Math.PI),m=o.acos(o.oneMinus(o.float(l).mul(2).add(1).div(r))),d=s(m,n);a.assign(o.min(a,o.distance(t,d)))}))}));var r=o.exp(e.size.mul(5).sub(5)).toVar(),t=e.blur.pow(4).toVar(),l=o.smoothstep(r.sub(t),r.add(t),a);return o.mix(e.color,e.background,l)}),go),_o={$name:"Processed wood",$width:260,scale:2,lengths:4,strength:.3,angle:0,color:new e.Color(7348256),background:new e.Color(15782048),seed:0},wo=C((e=>{e=w(e,_o);var a=o.radians(e.angle).toVar(),r=o.vec3(o.sub(o.positionGeometry.x.mul(o.cos(a)),o.positionGeometry.y.mul(o.sin(a))),o.add(o.positionGeometry.x.mul(o.sin(a)),o.positionGeometry.y.mul(o.cos(a))),o.positionGeometry.z).toVar(),t=e.scale.div(2).add(1).toVar(),s=r.mul(o.exp(t)).add(e.seed).toVar(),l=e.lengths.add(5).reciprocal().toVar(),n=o.mx_noise_float(s.mul(t,o.vec3(1,l,l)));return n=(n=n.mul(o.mx_noise_float(s.mul(o.vec3(25,1,1))).add(-1).mul(.2))).add(e.strength.sub(.5)).smoothstep(-.3,.3).oneMinus(),o.mix(e.color,e.background,n)}),_o),ho={$name:"Protozoa",scale:1.5,fat:.7,amount:.4,color:new e.Color(10526880),subcolor:new e.Color(14739711),background:new e.Color(15792383),seed:0},Co=o.Fn((([e,a])=>o.mx_noise_float(e).mul(a).clamp(-3.14,3.14).cos().add(1).div(2))),zo=C((e=>{e=w(e,ho);var a=o.positionGeometry.mul(o.exp(e.scale.sub(1))).add(e.seed).toVar(),r=o.vec3(o.matcapUV,o.matcapUV.length()).toVar(),t=o.float(0).toVar(),s=o.float(0).toVar(),l=o.float(0).toVar(),n=o.float(0).toVar(),i=e.fat.add(.2).oneMinus().mul(60).add(30).toVar(),m=o.float(2).toVar(),d=e.amount.div(2).add(.5).exp().toVar();return o.Loop(10,(()=>{t.assign(Co(a.xyz.add(r),i)),s.assign(Co(a.yzx.add(r),i)),l.addAssign(t.mul(s).mul(m)),n.addAssign(t.max(s).mul(m)),a.assign(o.mix(a.mul(d),0,.4)),m.mulAssign(.9)})),o.mix(e.background,o.mix(e.color,e.subcolor,n.mul(.1)),l)}),ho),Go={$name:"Rotator",$positionNode:!0,$selectorPlanar:!0,angles:new e.Vector3(.4,-.6,0),center:new e.Vector3(0,0,0),selectorCenter:new e.Vector3(0,0,0),selectorAngles:new e.Vector2(0,0),selectorWidth:2},ko=o.Fn((([e,a])=>{var r=f(e,a.selectorAngles,a.selectorCenter,a.selectorWidth),t=x(a.angles.mul(r)),s=y(a.center),l=y(a.center.negate());return s.mul(t).mul(l).mul(o.vec4(e,1)).xyz})),Mo=C((e=>(e=w(e,Go),ko(o.positionGeometry,e))),Go);Mo.normal=C((e=>{e=w(e,Go);var a=o.positionGeometry,r=o.normalLocal.normalize().toVar(),t=o.tangentLocal.normalize().mul(.01).toVar(),s=o.cross(r,t).normalize().mul(.01).toVar(),l=ko(a,e),n=ko(a.add(t),e),i=ko(a.add(s),e),m=o.sub(n,l),d=o.sub(i,l);return o.transformNormalToView(o.cross(m,d).normalize())}),Go);var $o={$name:"Rough clay",$normalNode:!0,scale:2,bump:.5,curvature:.2,seed:0},Ao=o.Fn((([e,a,r,t])=>{var s=o.mx_worley_noise_float(e.add(o.mx_noise_float(e).mul(t))).add(.8).pow(5).toVar();return s.addAssign(s.pow(.5)),e.add(a.mul(s).mul(r))})),Lo=C((e=>{var a=(e=w(e,$o)).bump.div(50).toVar(),r=o.positionGeometry.mul(o.exp(e.scale.div(2))).add(e.seed.sin().mul(10)).toVar(),t=o.normalLocal.normalize().toVar(),s=o.tangentLocal.normalize().mul(.001).toVar(),l=o.cross(t,s).normalize().mul(.001).toVar(),n=Ao(r,t,a,e.curvature),i=Ao(r.add(s),t,a,e.curvature),m=Ao(r.add(l),t,a,e.curvature),d=o.sub(i,n),u=o.sub(m,n);return o.transformNormalToView(o.cross(d,u).normalize())}),$o),Fo={$name:"Runny eggs",scale:1,sizeYolk:.2,sizeWhite:.7,colorYolk:new e.Color("orange"),colorWhite:new e.Color("white"),colorBackground:new e.Color("lightgray"),seed:0},Io=C((e=>{e=w(e,Fo);var a=o.positionGeometry.mul(o.exp(e.scale.div(1))).add(e.seed.sin().mul(10)).toVar(),r=e.sizeYolk.oneMinus(),t=e.sizeWhite.oneMinus(),s=o.mx_worley_noise_float(a).toVar(),l=s.add(t).pow(8).oneMinus().clamp(-.5,1),n=s.add(r).pow(18).oneMinus().clamp(0,1).pow(.4).clamp(0,1);return o.mix(e.colorBackground,o.mix(e.colorWhite,e.colorYolk,n),l)}),Fo),Po=o.Fn((([e,a,r,t,s])=>{var l=o.mx_worley_noise_float(e).toVar(),n=l.add(s).pow(8).oneMinus(),i=l.add(t).pow(18).oneMinus().clamp(0,1),m=o.mix(0,o.mix(0,1,i),n);return e.add(a.mul(m).mul(r))}));Io.normal=C((e=>{e=w(e,Fo);var a=.05,r=o.positionGeometry.mul(o.exp(e.scale.div(1))).add(e.seed.sin().mul(10)).toVar(),t=o.normalLocal.normalize().toVar(),s=o.tangentLocal.normalize().mul(.001).toVar(),l=o.cross(t,s).normalize().mul(.001).toVar(),n=e.sizeYolk.oneMinus(),i=e.sizeWhite.oneMinus(),m=Po(r,t,a,n,i),d=Po(r.add(s),t,a,n,i),u=Po(r.add(l),t,a,n,i),c=o.sub(d,m),p=o.sub(u,m);return o.transformNormalToView(o.cross(c,p).normalize())}),Fo),Io.roughness=C((e=>{e=w(e,Fo);var a=o.positionGeometry.mul(o.exp(e.scale.div(1))).add(e.seed.sin().mul(10)).toVar(),r=e.sizeYolk.oneMinus();return o.mx_worley_noise_float(a).toVar().add(r).pow(18).clamp(0,1)}),Fo);var To={$name:"rust",scale:2,iterations:8,amount:-.3,opacity:.5,noise:.5,noiseScale:.5,color:new e.Color(12615680),background:new e.Color(32),seed:0},So=o.Fn((e=>{var a=o.positionGeometry.mul(o.exp(e.scale.div(4).add(-1))).add(e.seed).toVar(),r=e.amount.mul(o.mx_noise_float(a.mul(e.amount.div(2).add(4))).add(4)).toVar(),t=o.mx_noise_float(a).toVar();return o.Loop(e.iterations,(()=>{a.mulAssign(2),t.addAssign(o.mx_noise_float(a))})),t.subAssign(o.mx_noise_float(a.mul(2)).abs()),t.assign(t.sub(r).clamp(0,15)),t})),Eo=C((e=>{e=w(e,To);var a=So(e).mul(1.25).pow(.5),r=o.positionGeometry.mul(o.exp(e.scale.add(e.noiseScale.mul(3),2)));return a.addAssign(e.noise.mul(o.mx_noise_float(r).abs().add(.1).pow(2))),o.mix(e.color,e.background,a)}),To);Eo.opacity=C((o=>(o=w(o,To),So(o).mul(o.opacity.add(.2)).oneMinus())),To);var Ro={$name:"Satin",scale:2,color:new e.Color(7373055),background:new e.Color(80),seed:0},Bo=C((e=>{e=w(e,Ro);var a=o.positionGeometry.toVar(),r=o.exp(e.scale.div(3)).toVar(),t=o.mx_noise_float(o.vec3(o.mx_noise_float(o.vec3(a.x.mul(2),a.y,a.z).mul(r)),o.mx_noise_float(o.vec3(a.x,a.y.mul(2),a.z).mul(r)),o.mx_noise_float(o.vec3(a.x,a.y,a.z.mul(2)).mul(r))).mul(r).add(e.seed));return t=o.pow(o.abs(t),3).mul(20),o.mix(e.background,e.color,t)}),Ro);Bo.defaults={$name:"Satin",scale:2,color:new e.Color(7373055),background:new e.Color(80),seed:0};var Wo={$name:"Scaler",$positionNode:!0,$selectorPlanar:!0,scales:new e.Vector3(.01,.9,1.7),center:new e.Vector3(0,0,0),selectorCenter:new e.Vector3(0,0,0),selectorAngles:new e.Vector2(0,0),selectorWidth:2},qo=o.Fn((([e,a])=>{var r=f(e,a.selectorAngles,a.selectorCenter,a.selectorWidth),t=v(o.mix(o.vec3(1,1,1),a.scales,r)),s=y(a.center),l=y(a.center.negate());return s.mul(t).mul(l).mul(o.vec4(e,1)).xyz})),No=C((e=>(e=w(e,Wo),qo(o.positionGeometry,e))),Wo);No.normal=C((e=>{e=w(e,Wo);var a=o.positionGeometry,r=o.normalLocal.normalize().toVar(),t=o.tangentLocal.normalize().mul(.01).toVar(),s=o.cross(r,t).normalize().mul(.01).toVar(),l=qo(a,e),n=qo(a.add(t),e),i=qo(a.add(s),e),m=o.sub(n,l),d=o.sub(i,l);return o.transformNormalToView(o.cross(m,d).normalize())}),Wo);var Do={$name:"Scepter head",xFactor:10,yFactor:22,zFactor:10,colorRim:new e.Color(16777215),colorA:new e.Color(7397631),colorB:new e.Color(3145983)},Oo=C((e=>{e=w(e,Do);var a=o.positionGeometry,s=a.x.mul(m(e.xFactor,0,100,1.35,30)).toVar(),l=a.y.mul(m(e.yFactor,0,100,1.35,30)).toVar(),n=a.z.mul(m(e.zFactor,0,100,1.35,30)).toVar(),i=o.cos(s).toVar(),d=o.cos(l).toVar(),u=o.cos(n).toVar(),c=o.mx_noise_float(o.vec3(a.x.div(i),a.y.div(d),a.z.div(u)));c=o.sign(c).mul(o.abs(c).pow(.75));var p=o.abs(o.mul(s,o.tan(s)).add(1).div(o.cos(s))),x=o.abs(o.mul(l,o.tan(l)).add(1).div(o.cos(l))),v=o.abs(o.mul(n,o.tan(n)).add(1).div(o.cos(n))),y=o.vec3().toVar(),f=o.abs(o.floor(s.mul(2/Math.PI).add(1).div(2))),g=o.abs(o.floor(l.mul(2/Math.PI).add(1).div(2))),b=o.abs(o.floor(n.mul(2/Math.PI).add(1).div(2))),V=o.mod(o.add(f,g,b),2);y.assign(t(o.mix(e.colorA,e.colorB,V)));var _=r(y.x,y.y,y.z.mul(c)).toVar();y.assign(t(e.colorRim));var h=r(y.x,y.y,o.mul(2,c,y.z)).toVar();return o.mix(_,h,o.remapClamp(o.max(p,o.max(x,v)),45,65))}),Do),Uo={$name:"Scream",scale:2,variety:1,color:new e.Color(15790176),background:new e.Color(13668496),seed:0},Yo=C((e=>{e=w(e,Uo);var a=o.positionGeometry.mul(o.exp(e.scale)).add(e.seed).toVar(),s=o.mx_noise_float(o.add(o.sin(a.xyz),o.cos(a.yzx)));a.assign(o.positionGeometry.mul(o.exp(e.scale).mul(s)).add(e.seed));s=o.mx_noise_float(o.add(o.sin(a.xyz),o.cos(a.yzx)).mul(2));var l=o.mix(e.background,e.color,s).toVar(),n=t(l).toVar();return r(o.add(n.x,e.variety.mul(o.sin(s.mul(Math.PI))).mul(.5)),n.y,n.z)}),Uo);Yo.defaults={$name:"Scream",scale:2,variety:1,color:new e.Color(15790176),background:new e.Color(13668496),seed:0};var jo={$name:"Simplex noise",scale:2,balance:0,contrast:0,color:new e.Color(16777215),background:new e.Color(0),seed:0},Ho=C((e=>{e=w(e,jo);var a=o.positionGeometry.mul(o.exp(e.scale)).add(e.seed),r=o.clamp(0,1,o.mx_noise_float(a).mul(.5,o.exp(e.contrast)).add(.5,e.balance));return o.mix(e.background,e.color,r)}),jo),Zo={$name:"Stars",scale:2,density:2,variation:0,color:new e.Color(16774640),background:new e.Color(96),seed:0},Xo=C((e=>{e=w(e,Zo);var a=o.positionGeometry.mul(o.exp(e.scale.div(2).add(3))).add(e.seed).toVar(),s=o.abs(o.mx_noise_float(a)).pow(10).mul(10);s=s.mul(o.exp(e.density.sub(2)));var l=o.select(s.greaterThan(.1),e.variation.mul(o.mx_noise_float(a)),0),n=t(o.mix(e.background,e.color,s));return r(o.add(n.x,l),n.y,n.z)}),Zo),Ko={$name:"Static noise",scale:2,balance:0,contrast:0,delay:0,seed:0},Qo=C((e=>{e=w(e,Ko);var a=o.screenCoordinate.div(o.exp(e.scale)).add(e.seed),r=e.delay.sub(1).mul(5).exp(),t=o.time.div(r).round().mul(r),s=d(t.sin()).mul(1e3),l=o.clamp(0,1,o.mx_noise_float(a.add(s)));return l=l.mul(.5,o.exp(e.contrast)).add(.5,e.balance),o.vec3(l)}),Ko),Jo={$name:"Supersphere",$positionNode:!0,exponent:3},oe=o.Fn((([e,a])=>{var r=o.float(2).pow(a.exponent),t=e.div(e.length()).toVar(),s=t.x.abs().pow(r).add(t.y.abs().pow(r)).add(t.z.abs().pow(r)).pow(o.float(1).div(r));return t.div(s)})),ee=C((e=>(e=w(e,Jo),oe(o.positionGeometry,e))),Jo);ee.normal=C((e=>{e=w(e,Jo);var a=o.positionGeometry,r=o.normalLocal.normalize().toVar(),t=o.tangentLocal.normalize().mul(.01).toVar(),s=o.cross(r,t).normalize().mul(.01).toVar(),l=oe(a,e),n=oe(a.add(t),e),i=oe(a.add(s),e),m=o.sub(n,l),d=o.sub(i,l);return o.transformNormalToView(o.cross(m,d).normalize())}),Jo);var ae={$name:"Tiger fur",scale:2,lengths:4,blur:.3,strength:.3,hairs:.5,color:new e.Color(16755200),bottomColor:new e.Color(16777198),seed:0},re=C((e=>{var a=(e=w(e,ae)).scale.div(2).add(1).toVar(),r=o.positionGeometry.mul(o.exp(a)).add(e.seed).toVar(),t=e.lengths.add(5).reciprocal().toVar(),s=e.hairs.mul(.3).toVar(),l=o.mx_noise_float(r.mul(a,o.vec3(1,t,t)));l=(l=l.add(o.mx_noise_float(r.mul(o.vec3(25,1,1))).add(1).mul(s))).add(e.strength.sub(.5)).smoothstep(e.blur.negate(),e.blur).oneMinus();var n=o.positionGeometry.y.add(s.sub(.5)).smoothstep(-1,.5);return o.mix(e.bottomColor,e.color,n).mul(l)}),ae),te={$name:"Translator",$positionNode:!0,$selectorPlanar:!0,distance:new e.Vector3(-.5,0,.2),selectorCenter:new e.Vector3(0,0,0),selectorAngles:new e.Vector2(0,0),selectorWidth:.7},se=o.Fn((([e,a])=>{var r=f(e,a.selectorAngles,a.selectorCenter,a.selectorWidth);return y(a.distance.mul(r)).mul(o.vec4(e,1)).xyz})),le=C((e=>(e=w(e,te),se(o.positionGeometry,e))),te);le.normal=C((e=>{e=w(e,te);var a=o.positionGeometry,r=o.normalLocal.normalize().toVar(),t=o.tangentLocal.normalize().mul(.01).toVar(),s=o.cross(r,t).normalize().mul(.01).toVar(),l=se(a,e),n=se(a.add(t),e),i=se(a.add(s),e),m=o.sub(n,l),d=o.sub(i,l);return o.transformNormalToView(o.cross(m,d).normalize())}),te);var ne={$name:"Voronoi cells",scale:2,variation:0,facet:0,color:new e.Color(0),background:new e.Color(12636415),seed:0},ie=o.Fn((([e])=>e.add(o.mx_noise_float(e.mul(Math.PI))))),me=C((e=>{e=w(e,ne);var a=o.positionGeometry.mul(o.exp(e.scale.div(2).add(.5))).add(e.seed).toVar(),r=a.round().toVar(),t=r.toVar(),s=o.float(1).toVar(),l=o.vec3().toVar(),n=o.float().toVar(),i=o.float(0).toVar();o.Loop(27,(()=>{var e=i.mod(3).sub(1),m=i.div(3).floor().mod(3).sub(1),d=i.div(9).floor().sub(1);l.assign(r.add(o.vec3(e,m,d))),n.assign(a.distance(ie(l)).add(o.mx_noise_float(a).div(5))),o.If(n.lessThan(s),(()=>{s.assign(n),t.assign(l)})),i.addAssign(1)}));var m=o.mx_noise_float(t.mul(Math.PI)).toVar(),d=o.mix(s,m.add(1).div(2),e.facet),u=o.mix(e.color,e.background,d).toVar(),c=o.vec3(m.mul(16.8),m.mul(31.4159),m.mul(27.1828)).sin().add(1).div(2);return o.mix(u,o.mix(u,c,e.variation),e.variation)}),ne),de={$name:"Water Drops",$normalNode:!0,scale:1.4,density:.5,bump:.6,seed:0},ue=o.Fn((([e,a,r,t,s])=>{var l=o.mx_noise_float(e.add(s)).add(t).clamp(0,1);return l=o.cos(l.mul(Math.PI)).add(1).pow(.5).toVar(),e.add(l.mul(a,r))})),ce=C((e=>{e=w(e,de);var a=o.positionGeometry.mul(o.exp(e.scale.div(1).add(1))).toVar(),r=o.normalLocal.normalize().toVar(),t=o.tangentLocal.normalize().mul(.001).toVar(),s=o.cross(r,t).normalize().mul(.001).toVar(),l=o.remap(e.density,0,1,1.5,.7).toVar(),n=o.vec3(o.sin(e.seed).mul(100),o.cos(e.seed.div(2)).mul(100),o.sin(e.seed.div(3)).mul(100)).toVar(),i=ue(a,r,e.bump,l,n),m=ue(a.add(t),r,e.bump,l,n),d=ue(a.add(s),r,e.bump,l,n),u=o.sub(m,i),c=o.sub(d,i);return o.transformNormalToView(o.cross(u,c).normalize())}),de),pe={$name:"Watermelon",scale:2,stripes:12,variation:.5,noise:.25,color:new e.Color("yellowgreen"),background:new e.Color("darkgreen"),flat:0,seed:0},xe=C((e=>{e=w(e,pe);var a=o.select(e.flat,e.variation.mul(.85).add(.15),e.variation),r=o.positionGeometry.mul(o.exp(e.scale.div(4).add(2))).add(e.seed).toVar(),t=o.select(e.flat,o.screenUV,o.equirectUV(o.positionGeometry.normalize())).toVar(),s=t.x.mul(e.stripes.round(),o.select(e.flat,Math.PI,2*Math.PI)).add(o.mx_noise_float(r.mul(o.vec3(1,.3,1))).mul(2)).sin().add(.5).div(2).mul(t.y.remap(0,1,-Math.PI,Math.PI).cos().add(1.2).clamp(0,1)).add(a.mul(2,o.mx_noise_float(r.mul(1.5)).div(2))).add(a.mul(2,o.mx_noise_float(r.mul(4)).div(6))).toVar();return s.assign(s.mix(s.round(),.75).add(o.mx_noise_float(r.mul(2)).mul(e.noise,.5)).add(o.mx_noise_float(r.mul(3)).mul(e.noise,1)).add(o.mx_noise_float(r.mul(15)).mul(e.noise,.2)).clamp(0,1)),o.mix(e.background,e.color,s).toVar()}),pe),ve={$name:"Wood",scale:2.5,rings:4.5,lengths:1,angle:0,fibers:.3,fibersDensity:10,color:new e.Color(.8,.4,0),background:new e.Color(.4,.1,0),seed:0},ye=C((e=>{e=w(e,ve);var a=o.radians(e.angle).toVar(),r=o.vec3(o.sub(o.positionGeometry.x.mul(o.cos(a)),o.positionGeometry.y.mul(o.sin(a))),o.add(o.positionGeometry.x.mul(o.sin(a)),o.positionGeometry.y.mul(o.cos(a))),o.positionGeometry.z).toVar(),t=r.mul(o.exp(e.scale.sub(3)).mul(o.vec3(o.reciprocal(e.lengths),4,o.reciprocal(e.lengths)))).add(e.seed).toVar(),s=o.mx_noise_float(t).add(1).mul(10).mul(e.rings);s=s.add(s.cos()).cos().add(1).div(2);var l=o.float(0).toVar(),n=o.float(0).toVar(),i=o.exp(e.scale.sub(2)).mul(o.vec3(1,e.fibersDensity,1)).toVar(),m=o.float(2).toVar();return o.Loop(10,(()=>{l.addAssign(o.mul(m,o.mx_noise_float(r.mul(i).add(e.seed)))),n.addAssign(m),i.mulAssign(1.8),m.mulAssign(.6)})),l.assign(o.mul(l,5).div(n).mul(10).sin().add(1).div(2)),o.mix(e.color,e.background,o.mix(s,l,e.fibers))}),ve),fe={$name:"Zebra lines",scale:2,thinness:.5,phi:0,theta:0,color:new e.Color(0),background:new e.Color(16777215),flat:0},ge=C((e=>{e=w(e,fe);var a=o.select(e.flat,o.positionGeometry,o.positionGeometry.normalize()).toVar(),r=o.select(e.flat,o.vec2(o.cos(e.phi),o.sin(e.phi)),s(e.phi,e.theta)).toVar(),t=o.select(e.flat,o.clamp(r.dot(a),-2,2),o.acos(o.clamp(r.dot(a),-1,1))).toVar(),l=o.exp(e.scale.add(1)).toVar(),n=o.sin(t.mul(l)).sub(e.thinness.sub(.5).mul(2));return n=o.clamp(n.mul(1e3).div(l),-1,1).mul(.5).add(.5),o.mix(e.background,e.color,n)}),fe),be={$name:"Circle decor",scale:2,grains:.2,complexity:1,blur:.2,color:new e.Color(0),background:new e.Color(16777215),seed:0},Ve=C((e=>{e=w(e,be);var a=o.positionGeometry.mul(o.exp(e.scale.div(4))).add(e.seed).toVar(),r=a.mul(2).toVar(),t=o.mx_worley_noise_float(a),s=o.mx_worley_noise_float(r),l=o.mx_worley_noise_float(a.mul(e.grains.mul(4).add(2))).mul(2),n=o.mx_noise_float(a).div(2).add(1),i=t.min(s,l).clamp(0,1).mul(e.complexity.add(2).exp(),n,Math.PI).sin().smoothstep(e.blur.negate(),e.blur);return o.mix(e.color,e.background,i.oneMinus())}),be),_e={$name:"Reticular veins",scale:2,reticulation:5,strength:.2,organelles:.2,color:new e.Color(16777200),background:new e.Color(2129952),seed:0},we=C((e=>{e=w(e,_e);var a=o.positionGeometry.mul(o.exp(e.scale.div(2).add(.5))).add(e.seed).toVar(),r=o.mx_worley_noise_float(a.mul(1)),t=o.mx_worley_noise_float(a.add(100).mul(e.reticulation)).mul(e.strength),s=o.mx_noise_float(a.mul(100)).mul(e.strength,e.organelles),l=r.add(t).add(s);return o.mix(e.background,e.color,l)}),_e),he={$name:"Roman paving",scale:2,depth:.5,seed:0},Ce=C((e=>{e=w(e,he);var a=o.positionGeometry.mul(o.exp(e.scale)).add(e.seed).toVar(),r=o.mx_worley_noise_vec2(a).toVar();return r.y.sub(r.x).pow(e.depth.mul(3).sub(3).exp()).smoothstep(0,1)}),he),ze={$name:"Crumpled fabric",$width:260,scale:2,pinch:.5,color:new e.Color(11596031),subcolor:new e.Color(4210928),background:new e.Color(12288),seed:0},Ge=C((e=>{e=w(e,ze);var a=o.positionGeometry.mul(o.exp(e.scale.sub(.5))).add(e.seed).toVar();o.Loop(4,(()=>{var r=o.mx_noise_float(a.xyz).mul(e.pinch),t=o.mx_noise_float(a.yzx).mul(e.pinch),s=o.mx_noise_float(a.zxy).mul(e.pinch);a.addAssign(o.vec3(r,t,s))}));var r=o.mx_noise_float(a).add(1).div(2).clamp(0,1),t=e.color.mul(r.mul(2).sub(1).abs().oneMinus()),s=e.subcolor.mul(r).pow(2),l=e.background.mul(r.oneMinus().pow(2));return t.add(s).add(l)}),ze),ke={$name:"Isolayers",scale:2,layers:10,edge:.5,darkness:0,color:new e.Color(16777200),background:new e.Color(16728128),seed:0},Me=C((e=>{e=w(e,ke);var a=o.positionGeometry.mul(o.exp(e.scale.sub(1))).add(e.seed).toVar(),s=e.edge.remap(0,1,40,10),l=o.mx_noise_float(a).mul(1.2).add(1).div(2),n=l.mul(e.layers).round().div(e.layers).clamp(0,1),i=l.sub(o.float(.53).div(e.layers)).mul(e.layers).fract().mul(o.float(2).pow(s.reciprocal())).pow(s).sub(1).abs().oneMinus(),m=o.mix(t(e.background),t(e.color),n).toVar();return m.z.mulAssign(o.mix(1,n.mul(1.5),e.darkness).clamp(0,1)),r(m.x,m.y,m.z).sub(i)}),ke);Object.defineProperty(exports,"noise",{enumerable:!0,get:function(){return o.mx_noise_float}}),exports.TSLFn=C,exports.applyEuler=l,exports.brain=G,exports.camouflage=M,exports.caveArt=A,exports.circleDecor=Ve,exports.circles=F,exports.clouds=T,exports.concrete=R,exports.cork=q,exports.crumpledFabric=Ge,exports.dalmatianSpots=D,exports.darthMaul=U,exports.dynamic=function(a){var r={};for(var[t,s]of Object.entries(a))"$"!=t[0]&&(s instanceof e.Vector3?r[t]=o.uniform(s,"vec3"):r[t]=o.uniform(s));return r},exports.dysonSphere=X,exports.entangled=Q,exports.fordite=oo,exports.gasGiant=ao,exports.grid=to,exports.hideFallbackWarning=function(){V&&(_>0?_--:(V.style.display="none",V=null))},exports.hsl=r,exports.isolayers=Me,exports.isolines=lo,exports.karstRock=io,exports.marble=uo,exports.matRotX=u,exports.matRotY=c,exports.matRotYXZ=x,exports.matRotZ=p,exports.matScale=v,exports.matTrans=y,exports.neonLights=po,exports.noised=h,exports.normalVector=b,exports.overlayPlanar=g,exports.photosphere=vo,exports.planet=fo,exports.polkaDots=Vo,exports.prepare=w,exports.processedWood=wo,exports.protozoa=zo,exports.remapExp=m,exports.reticularVeins=we,exports.romanPaving=Ce,exports.rotator=Mo,exports.roughClay=Lo,exports.runnyEggs=Io,exports.rust=Eo,exports.satin=Bo,exports.scaler=No,exports.scepterHead=Oo,exports.scream=Yo,exports.selectPlanar=f,exports.showFallbackWarning=async function(){if(null!=navigator.gpu&&await navigator.gpu.requestAdapter())return;(V=document.createElement("div")).innerHTML='\n\t<div style="font-size:1.25em; font-weight:bold;">PLEASE, WAIT</div>\n\t<div  style="font-size:0.85em; font-weight:100;" >NO WEBGPU &mdash; TRYING WEBGL2</div>\n\t<div id="counter"></div>\n\t',V.style.left="calc(50% - 8em)",V.style.width="16em",V.style.fontFamily="Bahnschrifts, Arial",V.style.position="absolute",V.style.bottom="20px",V.style.padding="12px 6px",V.style.border="1px solid white",V.style.borderRadius="4px",V.style.background="rgba(0,0,0,0.5)",V.style.color="white",V.style.textAlign="center",V.style.opacity="0.8",V.style.outline="none",V.style.zIndex="999",document.body.appendChild(V)},exports.simplexNoise=Ho,exports.spherical=s,exports.stars=Xo,exports.staticNoise=Qo,exports.supersphere=ee,exports.tigerFur=re,exports.toHsl=t,exports.translator=le,exports.vnoise=d,exports.voronoiCells=me,exports.waterDrops=ce,exports.watermelon=xe,exports.wood=ye,exports.zebraLines=ge;
